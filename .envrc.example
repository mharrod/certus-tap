# ============================================================================
# Certus Local Development Environment - EXAMPLE
# ============================================================================
# Copy this file to .envrc and customize as needed
# Then run: direnv allow

# Environment marker
export CERTUS_ENV=local

# Python path - add project root to PYTHONPATH
export PYTHONPATH="${PWD}:${PYTHONPATH}"

# Auto-activate uv's virtual environment if it exists
if [ -f .venv/bin/activate ]; then
    source .venv/bin/activate
fi

# Load .env file for docker-compose if it exists
dotenv_if_exists

# Local service endpoints (matching docker-compose.full-dev.yml)
export OPENSEARCH_HOST=http://localhost:9200
export LOCALSTACK_ENDPOINT=http://localhost:4566
export NEO4J_URI=neo4j://localhost:7687
export NEO4J_USER=neo4j
export NEO4J_PASSWORD=password
export VICTORIAMETRICS_URL=http://localhost:8428
export REDIS_URL=redis://localhost:6379

# API endpoints (local)
export CERTUS_ASK_URL=http://localhost:8000
export CERTUS_TRUST_URL=http://localhost:8057
export CERTUS_ASSURANCE_URL=http://localhost:8056
export CERTUS_TRANSFORM_URL=http://localhost:8100

# Development flags
export LOG_LEVEL=INFO
export RELOAD=true

# Helpful aliases for local development
alias dev='just dev-up && just preflight-dev'
alias dev-stop='just dev-down'
alias dev-logs='docker compose -f docker-compose.full-dev.yml logs -f'
alias dev-rebuild='just dev-down && docker compose -f docker-compose.full-dev.yml build && just dev-up'

# Show environment info
echo "ðŸš€ Certus Local Development Environment"
echo "   Environment: $CERTUS_ENV"
echo "   Python: $(python --version 2>/dev/null || echo 'not in venv')"
echo ""
echo "   Quick start:"
echo "     just dev-up          - Start all services"
echo "     just preflight-dev   - Check health"
echo "     just dev-down        - Stop all services"
echo ""
